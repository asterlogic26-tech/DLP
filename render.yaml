services:
  # Backend Service (Python/FastAPI)
  - type: web
    name: dlp-backend
    runtime: python
    region: singapore # Choose your preferred region
    plan: free # or starter/standard
    buildCommand: pip install -r backend/requirements.txt
    startCommand: uvicorn backend.main:app --host 0.0.0.0 --port 10000
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: RAZORPAY_KEY
        sync: false # User must provide this in dashboard
      - key: RAZORPAY_SECRET
        sync: false
      - key: RAZORPAY_WEBHOOK_SECRET
        sync: false
      # - key: DATABASE_URL
      #   fromDatabase:
      #     name: dlp-db
      #     property: connectionString

  # Frontend Service (React/Vite)
  - type: static
    name: dlp-dashboard
    runtime: static
    region: singapore
    plan: free
    buildCommand: cd dashboard && npm install && npm run build
    publishDir: dashboard/dist
    envVars:
      - key: VITE_API_URL
        fromService:
          type: web
          name: dlp-backend
          property: url
    routes:
      - type: rewrite
        source: /**
        destination: /index.html

# databases:
#   - name: dlp-db
#     region: singapore
#     plan: free # Note: Free DBs expire in 90 days on Render
